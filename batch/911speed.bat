@echo off
rem This is the windows batch file program to quickly check -
rem internet speed of a windows host during incident handling.
rem You are required to install Matt Martz's speedtest from:
rem https://github.com/sivel/speedtest-cli and grep,curl GNU binaries and,
rem set & tune your local variables between the below "----" remarks beforehand.
rem (the current values are just examples)
rem Shared by @unixfreaxjp, Oct 2021 - built & shared for incident response handling -
rem tool at malwaremustdie github repository. Version: 2.1
SETLOCAL
rem -------------------------------------------------------------
set testworkdir=C:\speedtest-cli-master
set testservercode=XXXXX
set mylocalhost=127.0.0.1
set checkipurl=ipinfo.io
set testcommand=speedtest-cli.py
set mycountry=XXXX
set mypause=ping -n 2 "%mylocalhost%"
rem -------------------------------------------------------------
echo .
echo change to workdir and checking speedtest version..
echo .
cd /d %testworkdir%
cd
python "%testcommand%" --version
echo .
%mypause% > NUL
:MYIP
echo .
echo Checking gobal IP address..
curl %checkipurl%
%mypause% > NUL
echo .
SET /P AREYOUQUIT=Enter (Q) to list servers then quit, or any key to continue..
IF /I "%AREYOUQUIT%" NEQ "Q" GOTO SPEEDTESTING
GOTO END
:SPEEDTESTING
echo .
echo Speed testing..
echo .
%mypause% > NUL
echo (first try../dedicated)
python "%testcommand%" --server "%testservercode%" --no-upload
%mypause% > NUL
echo .
SET /P AREYOUQUIT=Enter (Q) to list servers then quit, or any key for random speedtest..
IF /I "%AREYOUQUIT%" NEQ "Q" GOTO RANDOMSPEEDTESTING
GOTO END
:RANDOMSPEEDTESTING
%mypause% > NUL
echo .
echo (second try.. /random)
python "%testcommand%" --no-upload
%mypause% > NUL
SET /P AREYOUQUIT=Enter (Q) to list servers then quit, or any key to retry speedtest..
IF /I "%AREYOUQUIT%" NEQ "Q" GOTO SPEEDTESTING
:END
echo Just in case you want to manually check or modify:
python "%testcommand%" --list|grep "%mycountry%"
echo .
echo Type BELOW command with server number above for manual check..
echo python "%testcommand%" --server XXXXXX  --no-upload
%mypause% > NUL
echo .
echo .
cmd /k
cd /d %testworkdir%
ENDLOCAL
