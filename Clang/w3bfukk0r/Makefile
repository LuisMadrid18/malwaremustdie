BIN     = w3bfukk0r
VERSION = 0.2
prefix  = /usr/local
INSPATH = ${prefix}/bin/
CFLAGS  = -O2 -Wall -g -DVERSION=\"${VERSION}\"
LDFLAGS = -lssl -lcrypto
CC      = cc
DOCPATH = ${prefix}/share/doc/${BIN}
EXPATH = ${DOCPATH}/examples
MANPATH = ${prefix}/share/man/man1
SRC_w3bfukk0r       = $(wildcard *.c)
OBJ_w3bfukk0r       = ${SRC_w3bfukk0r:.c=.o}

.c.o :
	@echo CC $<
	@${CC} -c ${CFLAGS} $<

all : ${BIN}
	@echo "done."

${BIN}: options ${OBJ_w3bfukk0r}
	@echo LD $@
	@${CC} -Wall -o ${BIN} ${LDFLAGS} ${OBJ_w3bfukk0r}
	@strip ${BIN}

dist : clean
	@mkdir -p w3bfukk0r-${VERSION}
	@cp -R Doxyfile Makefile CHANGELOG LICENSE *.c *.h ${BIN}.1 words.txt README ${BIN}-${VERSION}
	@tar -cf ${BIN}-${VERSION}.tar ${BIN}-${VERSION}
	@gzip ${BIN}-${VERSION}.tar
	@rm -rf ${BIN}-${VERSION}
	@echo created distribution ${BIN}-${VERSION}.tar.gz

options : 
	@echo ${BIN} build options:
	@echo "CFLAGS = ${CFLAGS}"
	@echo "CC     = ${CC}"
	@echo "BIN    = ${BIN}"

install :
	@mkdir -p ${DOCPATH}
	@mkdir -p ${INSPATH}
	@mkdir -p ${MANPATH}
	@mkdir -p ${EXPATH}
	install -m644 CHANGELOG LICENSE README ${DOCPATH}
	install -m644 words.txt ${EXPATH}
	install -m644 ${BIN}.1 ${MANPATH}
	install ${BIN} ${INSPATH}

uninstall :
	rm -f ${INSPATH}${BIN}
	rm -rf ${DOCPATH}
	rm -rf ${EXPATH}
	rm -f ${MANPATH}/${BIN}.1

clean :
	rm -f ${BIN}
	rm -f $(OBJ_w3bfukk0r) core
	rm -rf doc

love :
	@echo "not war!"
